"use strict";var g=Object.defineProperty;var p=(n,r)=>g(n,"name",{value:r,configurable:!0});var d=require("./codemirror.cjs.js"),l=require("graphql"),b=require("./forEachState.cjs.js");require("./index.cjs.js");require("react");require("react/jsx-runtime");require("react-dom");function f(n,r,t){const i=j(t,m(r.string));if(!i)return;const e=r.type!==null&&/"|\w/.test(r.string[0])?r.start:r.end;return{list:i,from:{line:n.line,ch:e},to:{line:n.line,ch:r.end}}}p(f,"hintList");function j(n,r){if(!r)return y(n,o=>!o.isDeprecated);const t=n.map(o=>({proximity:x(m(o.text),r),entry:o}));return y(y(t,o=>o.proximity<=2),o=>!o.entry.isDeprecated).sort((o,s)=>(o.entry.isDeprecated?1:0)-(s.entry.isDeprecated?1:0)||o.proximity-s.proximity||o.entry.text.length-s.entry.text.length).map(o=>o.entry)}p(j,"filterAndSortList");function y(n,r){const t=n.filter(r);return t.length===0?n:t}p(y,"filterNonEmpty");function m(n){return n.toLowerCase().replaceAll(/\W/g,"")}p(m,"normalizeText");function x(n,r){let t=L(r,n);return n.length>r.length&&(t-=n.length-r.length-1,t+=n.indexOf(r)===0?0:.5),t}p(x,"getProximity");function L(n,r){let t,i;const e=[],o=n.length,s=r.length;for(t=0;t<=o;t++)e[t]=[t];for(i=1;i<=s;i++)e[0][i]=i;for(t=1;t<=o;t++)for(i=1;i<=s;i++){const u=n[t-1]===r[i-1]?0:1;e[t][i]=Math.min(e[t-1][i]+1,e[t][i-1]+1,e[t-1][i-1]+u),t>1&&i>1&&n[t-1]===r[i-2]&&n[t-2]===r[i-1]&&(e[t][i]=Math.min(e[t][i],e[t-2][i-2]+u))}return e[o][s]}p(L,"lexicalDistance");d.CodeMirror.registerHelper("hint","graphql-variables",(n,r)=>{const t=n.getCursor(),i=n.getTokenAt(t),e=T(t,i,r);return(e==null?void 0:e.list)&&e.list.length>0&&(e.from=d.CodeMirror.Pos(e.from.line,e.from.ch),e.to=d.CodeMirror.Pos(e.to.line,e.to.ch),d.CodeMirror.signal(n,"hasCompletion",n,e,i)),e});function T(n,r,t){const i=r.state.kind==="Invalid"?r.state.prevState:r.state,{kind:e,step:o}=i;if(e==="Document"&&o===0)return f(n,r,[{text:"{"}]);const{variableToType:s}=t;if(!s)return;const u=V(s,r.state);if(e==="Document"||e==="Variable"&&o===0){const c=Object.keys(s);return f(n,r,c.map(a=>({text:`"${a}": `,type:s[a]})))}if((e==="ObjectValue"||e==="ObjectField"&&o===0)&&u.fields){const c=Object.keys(u.fields).map(a=>u.fields[a]);return f(n,r,c.map(a=>({text:`"${a.name}": `,type:a.type,description:a.description})))}if(e==="StringValue"||e==="NumberValue"||e==="BooleanValue"||e==="NullValue"||e==="ListValue"&&o===1||e==="ObjectField"&&o===2||e==="Variable"&&o===2){const c=u.type?l.getNamedType(u.type):void 0;if(c instanceof l.GraphQLInputObjectType)return f(n,r,[{text:"{"}]);if(c instanceof l.GraphQLEnumType){const a=c.getValues();return f(n,r,a.map(h=>({text:`"${h.name}"`,type:c,description:h.description})))}if(c===l.GraphQLBoolean)return f(n,r,[{text:"true",type:l.GraphQLBoolean,description:"Not false."},{text:"false",type:l.GraphQLBoolean,description:"Not true."}])}}p(T,"getVariablesHint");function V(n,r){const t={type:null,fields:null};return b.forEachState(r,i=>{switch(i.kind){case"Variable":{t.type=n[i.name];break}case"ListValue":{const e=t.type?l.getNullableType(t.type):void 0;t.type=e instanceof l.GraphQLList?e.ofType:null;break}case"ObjectValue":{const e=t.type?l.getNamedType(t.type):void 0;t.fields=e instanceof l.GraphQLInputObjectType?e.getFields():null;break}case"ObjectField":{const e=i.name&&t.fields?t.fields[i.name]:null;t.type=e==null?void 0:e.type;break}}}),t}p(V,"getTypeInfo");
//# sourceMappingURL=hint.cjs2.js.map
